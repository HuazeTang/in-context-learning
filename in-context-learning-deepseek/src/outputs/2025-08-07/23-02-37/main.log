[2025-08-07 23:02:37,471][__main__][INFO] - Configuration:
model:
  _target_: src.models.deepseek_model.DeepSeekModel
  config:
    type: deepseek
    model_path: /root/autodl-tmp/data/model_ckpts/deepseek-ai/DeepSeek-R1-0528-Qwen3-8B
    tokenizer_path: /root/autodl-tmp/data/model_ckpts/deepseek-ai/DeepSeek-R1-0528-Qwen3-8B
    torch_dtype: float16
    device_map: cuda:0
    terminators:
    - </s>
    - <|endoftext|>
    chat_template: '{% for message in messages %}{{''<|start_header_id|>'' + message[''role'']
      + ''<|end_header_id|>


      '' + message[''content''] + ''<|eot_id|>'' }}{% endfor %}{% if add_generation_prompt
      %}{{''<|start_header_id|>assistant<|end_header_id|>


      ''}}{% endif %}'
    generation_params:
      max_new_tokens: 256
      temperature: 0.3
      top_p: 0.9
      do_sample: true
      eos_token_id: 151645
      output_hidden_states: false
      return_dict_in_generate: false
    layer_num: 32
dataset:
  _target_: src.datasets.MMLUDataset
  config:
    name: mmlu
    dataset_path: /root/autodl-tmp/data/datasets/cais/mmlu
    subjects:
    - high_school_biology
    - high_school_chemistry
    - high_school_physics
    - college_mathematics
    dev_split: dev
    test_split: test
    max_test_samples: 5000
    random_seed: 42
evaluation:
  _target_: src.evaluators.in_context_evaluator.RandomInContextEvaluator
  config:
    name: random_in_context
    system_prompt: You are an expert answering multiple choice questions. Analyze
      the question carefully and select the ONE correct option. Output ONLY the capital
      letter of your choice with NO additional text or explanation.
    num_shots: 5
    output_dir: ${hydra:runtime.output_dir}/results/
    extract_hidden_states: false

[2025-08-07 23:02:37,471][__main__][INFO] - Loading deepseek model...
[2025-08-07 23:03:17,506][__main__][INFO] - Loading mmlu dataset with subject ['high_school_biology', 'high_school_chemistry', 'high_school_physics', 'college_mathematics']
[2025-08-07 23:03:21,174][__main__][INFO] - Dev dataset size: 20
[2025-08-07 23:03:21,174][__main__][INFO] - Test dataset size: 764
[2025-08-07 23:03:21,175][__main__][INFO] - Loading random_in_context evaluator
[2025-08-07 23:03:21,182][__main__][INFO] - 
Starting evaluation...
[2025-08-07 23:05:56,633][__main__][INFO] - Processed 10/764 | Accuracy: 0.4000
[2025-08-07 23:08:31,853][__main__][INFO] - Processed 20/764 | Accuracy: 0.2000
[2025-08-07 23:11:09,238][__main__][INFO] - Processed 30/764 | Accuracy: 0.1667
[2025-08-07 23:13:45,719][__main__][INFO] - Processed 40/764 | Accuracy: 0.1250
[2025-08-07 23:16:21,264][__main__][INFO] - Processed 50/764 | Accuracy: 0.1400
[2025-08-07 23:18:57,101][__main__][INFO] - Processed 60/764 | Accuracy: 0.1500
[2025-08-07 23:21:33,120][__main__][INFO] - Processed 70/764 | Accuracy: 0.1571
[2025-08-07 23:24:08,485][__main__][INFO] - Processed 80/764 | Accuracy: 0.1500
[2025-08-07 23:26:43,835][__main__][INFO] - Processed 90/764 | Accuracy: 0.1333
[2025-08-07 23:29:20,261][__main__][INFO] - Processed 100/764 | Accuracy: 0.1200
[2025-08-07 23:31:55,494][__main__][INFO] - Processed 110/764 | Accuracy: 0.1182
